<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gavin</title>
    <link rel="stylesheet" href="/static/styles.css">
    <script src="/static/passwordCheck.js"></script>
</head>
<body>
    <div class="grid-bottom"></div>
    
    <div class="profile-container">
        <h2 class="profile-title">gavin</h2>
        <div class="content-section">
                <p class="profile-description">Gavin is so cool and awesome. really the best person ever. why doesnt everyone become as sexy and cool as her. i think that sometimes i need more words to be able to properly test what im doing because more words means theres a bigger paragraph so im adding more words in order to test my silly little layout :D</p>
            <div class="profile-image">
                <img src="/static/gavinEgger1.jpg" alt="eProfile" style="height:250; position: absolute; top: 0px; right: 50px;">
            </div>
        </div>
        <div class="profile-image">
            <img src = "/static/gavinEgger2.jpg" alt="eWilson" style="width: 300; position: relative; left: 30px;">
        </div>

        <h2 class="profile-title">send gavin a message:</h2>

        <form id="message-form">
            <textarea id="message-input" name="message" placeholder="enter message"></textarea>
            <input type="hidden" id="email-recipient" name="_email" value="gavin-egger@uiowa.edu"> <!-- Hidden email recipient -->
            <button class="send-msg-btn" type="submit">send</button>
        </form>
        <div id="message-status-container">
            <p id="message-status" style="display: none;">Message sent!</p>
        </div>
        
        
        <!-- <form method="POST" action="/submit-message">
            <textarea name="message" placeholder="enter message"></textarea>
            <button class="send-msg-btn" type="submit">send</button>
        </form> -->
        <div class="bottom-text-container">
            <a href="/" class="bottom-text">aeris</a>
            <a href="/logs" id="logs-link" class="protected-link">logs</a>
        </div>
    </div>

    <nav class="nav-container">
        <a href= "/" class="home-link">aeris</a>
        <div class="nav-buttons">
            <div class="dropdown">
                <button class="dropdown-btn">who we are</button>
                <div class="dropdown-content">
                    <a href="/static/elizabeth.html">elizabeth</a>
                    <a href="/static/gavin.html">gavin</a>
                    <a href="/static/kaylee.html">kaylee</a>
                    <a href="/static/luke.html">luke</a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropdown-btn">our projects</button>
                <div class="dropdown-content">
                    <a href="#" id="aetas-link">aetas</a>
                    <a href="#" id="lab1-link">lab one</a>
                    <a href="#" id="lab2-link">lab two</a>
                    <a href="#" id="lab3-link">lab three</a>
                    
                </div>
            </div>
        </div>
    </nav>

    <script>
        document.getElementById('message-form').addEventListener('submit', function (e) {
            e.preventDefault(); // Prevent the default form submission

            const messageInput = document.getElementById('message-input');
            const messageStatus = document.getElementById('message-status');
            const emailRecipient = document.getElementById('email-recipient').value;

            // Check if the message input is empty
            if (!messageInput.value.trim()) {
                // Show an error message if the input is empty
                messageStatus.style.display = 'block';
                messageStatus.style.color = 'red';
                messageStatus.textContent = 'Message cannot be empty!';
                
                // Hide the message after 3 seconds
                setTimeout(() => {
                    messageStatus.style.display = 'none';
                }, 3000);
                return; // Exit the function early
            }

            // Send the message to the server
            fetch('/submit-message', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: new URLSearchParams({ message: messageInput.value })
            })
            .then(response => {
                if (response.ok) {
                    // Send the email
                    return fetch('https://formsubmit.co/ajax/' + emailRecipient, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ message: messageInput.value })
                    });
                } else {
                    throw new Error('Failed to send message to the server.');
                }
            })
            .then(response => {
                if (response.ok) {
                    // Clear the input field and show a success message
                    messageInput.value = '';
                    messageStatus.style.display = 'block';
                    messageStatus.style.color = 'green';
                    messageStatus.textContent = 'Message sent!';
                    
                    // Hide the message after 3 seconds
                    setTimeout(() => {
                        messageStatus.style.display = 'none';
                    }, 3000);
                } else {
                    throw new Error('Failed to send email.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                messageStatus.style.display = 'block';
                messageStatus.style.color = 'red';
                messageStatus.textContent = 'Failed to send message. Please try again.';
            });
        });
    </script>


</body>
</html>